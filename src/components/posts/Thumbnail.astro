---
import { site } from "../../utils/consts";
import OptimizedImage from "./OptimizedImage.astro";

interface Props {
    alt?: string;
    src?: string;
}

const { alt = site.author, src = site.defaultThumbnailLink } = Astro.props;

const isLocal = src.startsWith("/media/");
const hasSvg = src.endsWith(".svg");
---

<figure class={hasSvg ? "thumbnail has-svg" : "thumbnail"}>
    {
        isLocal ? (
            <img src={src} alt={alt} loading="eager" />
        ) : (
            <OptimizedImage
                src={src}
                alt={alt}
                loading="eager"
                linkable={false}
            />
        )
    }
</figure>

<style>
    figure.thumbnail:has(picture, img) {
        display: grid;
        row-gap: var(--space-xs);
        place-items: center;
        width: 100%;
        height: calc(8rem + var(--space-xl) * 2);
        padding-inline: var(--space-xl);
        overflow: hidden;
        background-color: var(--color-primary-background-layer-ha);
        border-radius: var(--border-radius-m);
    }

    :global(img:is(figure.thumbnail:not(.has-svg) *)) {
        max-height: 8rem;
        border: solid min(0.8vw, 4px)
            light-dark(var(--beige-1), var(--beige-12));
        border-radius: 0;
        box-shadow: var(--box-shadow-m);
    }

    :global(img:is(figure.thumbnail.has-svg *)) {
        max-width: 4rem;
        max-height: 8rem;
        filter: drop-shadow(var(--box-shadow-m));
    }
</style>
